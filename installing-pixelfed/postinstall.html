<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Post-installation | Pixelfed Documentation</title>
    <meta name="description" content="Documentation for pixelfed">
    
    
    <link rel="preload" href="/assets/css/0.styles.1aed94de.css" as="style"><link rel="preload" href="/assets/js/app.b7dfad19.js" as="script"><link rel="preload" href="/assets/js/2.a454a886.js" as="script"><link rel="preload" href="/assets/js/11.9126097e.js" as="script"><link rel="prefetch" href="/assets/js/10.847782ba.js"><link rel="prefetch" href="/assets/js/12.a859a875.js"><link rel="prefetch" href="/assets/js/13.47743d9a.js"><link rel="prefetch" href="/assets/js/14.fe6f5b30.js"><link rel="prefetch" href="/assets/js/15.82064967.js"><link rel="prefetch" href="/assets/js/16.c6769722.js"><link rel="prefetch" href="/assets/js/17.e60e44fe.js"><link rel="prefetch" href="/assets/js/18.8dbe3c97.js"><link rel="prefetch" href="/assets/js/19.f0fd36f9.js"><link rel="prefetch" href="/assets/js/20.43e0f5b1.js"><link rel="prefetch" href="/assets/js/21.8b1776f4.js"><link rel="prefetch" href="/assets/js/3.6b092af1.js"><link rel="prefetch" href="/assets/js/4.a6bdcb64.js"><link rel="prefetch" href="/assets/js/5.50d77a97.js"><link rel="prefetch" href="/assets/js/6.ca635446.js"><link rel="prefetch" href="/assets/js/7.05ec0d20.js"><link rel="prefetch" href="/assets/js/8.2e33560f.js"><link rel="prefetch" href="/assets/js/9.f8eab9c5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1aed94de.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://avatars0.githubusercontent.com/u/38410642?s=200&amp;v=4" alt="Pixelfed Documentation" class="logo"> <span class="site-name can-hide">Pixelfed Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://pixelfed.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  pixelfed.org
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/pixelfed/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://pixelfed.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  pixelfed.org
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/pixelfed/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Installing Pixelfed</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/installing-pixelfed/prerequisites.html" class="sidebar-link">Pre-requisites</a></li><li><a href="/installing-pixelfed/installation.html" class="sidebar-link">Generic installation process</a></li><li><a href="/installing-pixelfed/postinstall.html" class="active sidebar-link">Post-installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/installing-pixelfed/postinstall.html#background-task-queue" class="sidebar-link">Background task queue</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/installing-pixelfed/postinstall.html#using-systemd" class="sidebar-link">Using systemd</a></li><li class="sidebar-sub-header"><a href="/installing-pixelfed/postinstall.html#using-supervisor" class="sidebar-link">Using Supervisor</a></li></ul></li><li class="sidebar-sub-header"><a href="/installing-pixelfed/postinstall.html#configure-your-https-reverse-proxy" class="sidebar-link">Configure your HTTPS reverse proxy</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/installing-pixelfed/postinstall.html#apache" class="sidebar-link">Apache</a></li><li class="sidebar-sub-header"><a href="/installing-pixelfed/postinstall.html#nginx" class="sidebar-link">Nginx</a></li><li class="sidebar-sub-header"><a href="/installing-pixelfed/postinstall.html#https-certificate" class="sidebar-link">HTTPS Certificate</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Running Pixelfed</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/running-pixelfed/administration.html" class="sidebar-link">Administration</a></li><li><a href="/running-pixelfed/migration.html" class="sidebar-link">Migrating to another machine</a></li><li><a href="/running-pixelfed/troubleshooting.html" class="sidebar-link">Troubleshooting your Pixelfed installation</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Technical documentation</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/technical-documentation/api.html" class="sidebar-link">v1 API</a></li><li><a href="/technical-documentation/artisan.html" class="sidebar-link">Laravel Artisan</a></li><li><a href="/technical-documentation/env.html" class="sidebar-link">Configuration</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Distro-specific Guides</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="post-installation"><a href="#post-installation" aria-hidden="true" class="header-anchor">#</a> Post-installation</h1> <p></p><div class="table-of-contents"><ul><li><a href="#background-task-queue">Background task queue</a><ul><li><a href="#using-systemd">Using systemd</a></li><li><a href="#using-supervisor">Using Supervisor</a></li></ul></li><li><a href="#configure-your-https-reverse-proxy">Configure your HTTPS reverse proxy</a><ul><li><a href="#apache">Apache</a></li><li><a href="#nginx">Nginx</a></li><li><a href="#https-certificate">HTTPS Certificate</a></li></ul></li></ul></div><p></p> <h2 id="background-task-queue"><a href="#background-task-queue" aria-hidden="true" class="header-anchor">#</a> Background task queue</h2> <div class="danger custom-block"><p class="custom-block-title">Make sure you set up Horizon!</p> <p>If Horizon is not running, you will notice that many things will fail, such as thumbnail generation, image optimization, avatar changes, and so on.</p></div> <p>Pixelfed uses Laravel Horizon for running tasks.</p> <p>If your user has the correct permissions to access Redis and the Pixelfed installation folder, then you can simply run <code>php artisan horizon</code> as that user in a terminal. This may be fine, but if you close the terminal then Horizon will also be terminated. Running directly is recommended only in deployments where a terminal can run uninterrupted, e.g. in a VM or using a utility such as GNU Screen or tmux.</p> <p>If you are running in production, it is more ideal to create a background service for running Pixelfed's task queue.</p> <h3 id="using-systemd"><a href="#using-systemd" aria-hidden="true" class="header-anchor">#</a> Using systemd</h3> <p>An example systemd unit file is as such:</p> <div class="language-bash extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-bash"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Pixelfed task queueing via Laravel Horizon
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target
<span class="token assign-left variable">Requires</span><span class="token operator">=</span>mariadb
<span class="token assign-left variable">Requires</span><span class="token operator">=</span>php-fpm
<span class="token assign-left variable">Requires</span><span class="token operator">=</span>redis
<span class="token assign-left variable">Requires</span><span class="token operator">=</span>nginx

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>simple
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/bin/php /home/pixelfed/artisan horizon
<span class="token assign-left variable">User</span><span class="token operator">=</span>http
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>on-failure

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">Using correct paths and service names</p> <p>The example above assumes you are using MariaDB and Nginx, that your distribution's PHP packages do not have versioned names, and that your distribution uses the <code>http</code> user to serve Nginx. It also assumes that you have installed Pixelfed in /home/pixelfed in accordance with the rest of the installation process documentation. Some changes you may need to make include:</p> <ul><li>Replacing <code>mariadb</code> with <code>postgresql</code> or <code>mysql</code></li> <li>Replacing <code>php-fpm</code> with your distro's PHP-FPM package name, e.g. <code>php7.3-fpm</code></li> <li>Replacing <code>nginx</code> with <code>apache</code>, or replacing <code>Requires</code> with <code>Wants</code> if you are not running in a production environment</li> <li>Replacing <code>/usr/bin/php</code> or <code>/home/pixelfed/artisan</code> with the correct paths, e.g. <code>/usr/bin/php7.3</code> or <code>/path/to/pixelfed/artisan</code></li> <li>Replacing <code>User=http</code> to reflect the app user, e.g. <code>User=pixelfed</code> or commenting this line in order to run in the system slice.</li></ul></div> <p>If you create or copy this file to <code>/etc/systemd/system/pixelfed.service</code>, then you can use systemd to manage Pixelfed like any other background service:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl <span class="token punctuation">{</span>start,enable<span class="token punctuation">}</span> pixelfed
</code></pre></div><h3 id="using-supervisor"><a href="#using-supervisor" aria-hidden="true" class="header-anchor">#</a> Using Supervisor</h3> <p>It is also possible to use Supervisor to manage Horizon queues, but this method is currently not officially supported by Pixelfed. <a href="https://laravel.com/docs/5.8/queues#supervisor-configuration" target="_blank" rel="noopener noreferrer">Laravel Docs: Supervisor Configuation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="configure-your-https-reverse-proxy"><a href="#configure-your-https-reverse-proxy" aria-hidden="true" class="header-anchor">#</a> Configure your HTTPS reverse proxy</h2> <p>To translate HTTPS web requests to PHP workers, you will need to configure a reverse proxy.</p> <h3 id="apache"><a href="#apache" aria-hidden="true" class="header-anchor">#</a> Apache</h3> <p>Pixelfed includes a <code>public/.htaccess</code> file that is used to provide URLs without the index.php front controller in the path. Before serving Pixelfed with Apache, be sure to enable the <code>mod_rewrite</code> module in your Apache configuration so the <code>.htaccess</code> file will be honored by the server.</p> <p>If the <code>.htaccess</code> file that ships with Pixelfed does not work with your Apache installation, try this alternative:</p> <div class="language-php extra-class"><pre class="language-php"><code>Options <span class="token operator">+</span>FollowSymLinks <span class="token operator">-</span>Indexes
RewriteEngine On

RewriteCond <span class="token operator">%</span><span class="token punctuation">{</span><span class="token constant">HTTP</span><span class="token punctuation">:</span>Authorization<span class="token punctuation">}</span> <span class="token punctuation">.</span>
RewriteRule <span class="token punctuation">.</span><span class="token operator">*</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token constant">E</span><span class="token operator">=</span><span class="token constant">HTTP_AUTHORIZATION</span><span class="token punctuation">:</span><span class="token operator">%</span><span class="token punctuation">{</span><span class="token constant">HTTP</span><span class="token punctuation">:</span>Authorization<span class="token punctuation">}</span><span class="token punctuation">]</span>

RewriteCond <span class="token operator">%</span><span class="token punctuation">{</span><span class="token constant">REQUEST_FILENAME</span><span class="token punctuation">}</span> <span class="token operator">!</span><span class="token operator">-</span>d
RewriteCond <span class="token operator">%</span><span class="token punctuation">{</span><span class="token constant">REQUEST_FILENAME</span><span class="token punctuation">}</span> <span class="token operator">!</span><span class="token operator">-</span>f
RewriteRule <span class="token operator">^</span> index<span class="token punctuation">.</span>php <span class="token punctuation">[</span><span class="token constant">L</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="nginx"><a href="#nginx" aria-hidden="true" class="header-anchor">#</a> Nginx</h3> <p>Pixelfed includes a sample NGINX configuration at <code>contrib/nginx.conf</code>. You can copy the contents of this file or include it within your <code>nginx.conf</code>. Take note of the comments, and make sure to set the correct domain name and root path.</p> <div class="language-nginx extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-nginx"><code><span class="token keyword">server</span> <span class="token punctuation">{</span>
    <span class="token keyword">listen</span> <span class="token number">443</span> <span class="token keyword">ssl</span> http2<span class="token punctuation">;</span>
    <span class="token keyword">listen</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">443</span> <span class="token keyword">ssl</span> http2<span class="token punctuation">;</span>
    <span class="token keyword">server_name</span> pixelfed<span class="token punctuation">.</span>example<span class="token punctuation">;</span>                    <span class="token comment"># change this to your fqdn</span>
    <span class="token keyword">root</span> <span class="token operator">/</span>home<span class="token operator">/</span>pixelfed<span class="token operator">/</span>public<span class="token punctuation">;</span>                      <span class="token comment"># path to repo/public</span>

    <span class="token keyword">ssl_certificate</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span><span class="token keyword">ssl</span><span class="token operator">/</span><span class="token keyword">server</span><span class="token punctuation">.</span>crt<span class="token punctuation">;</span>       <span class="token comment"># generate your own</span>
    <span class="token keyword">ssl_certificate_key</span> <span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span><span class="token keyword">ssl</span><span class="token operator">/</span><span class="token keyword">server</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>   <span class="token comment"># or use letsencrypt</span>

    <span class="token keyword">ssl_protocols</span> TLSv1<span class="token punctuation">.</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">ssl_ciphers</span> EECDH<span class="token operator">+</span>AESGCM<span class="token punctuation">:</span>EECDH<span class="token operator">+</span>CHACHA20<span class="token punctuation">:</span>EECDH<span class="token operator">+</span>AES<span class="token punctuation">;</span>
    <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>

    <span class="token keyword">add_header</span> X<span class="token operator">-</span>Frame<span class="token operator">-</span>Options <span class="token string">&quot;SAMEORIGIN&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">add_header</span> X<span class="token operator">-</span>XSS<span class="token operator">-</span>Protection <span class="token string">&quot;1; mode=block&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">add_header</span> X<span class="token operator">-</span>Content<span class="token operator">-</span>Type<span class="token operator">-</span>Options <span class="token string">&quot;nosniff&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm <span class="token keyword">index</span><span class="token punctuation">.</span>php<span class="token punctuation">;</span>

    <span class="token keyword">charset</span> utf<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">;</span>

    <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
        <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>php<span class="token operator">?</span><span class="token variable">$query_string</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span>favicon<span class="token punctuation">.</span>ico <span class="token punctuation">{</span> <span class="token keyword">access_log</span> off<span class="token punctuation">;</span> <span class="token keyword">log_not_found</span> off<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">location</span> <span class="token operator">=</span> <span class="token operator">/</span>robots<span class="token punctuation">.</span>txt  <span class="token punctuation">{</span> <span class="token keyword">access_log</span> off<span class="token punctuation">;</span> <span class="token keyword">log_not_found</span> off<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">error_page</span> <span class="token number">404</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>php<span class="token punctuation">;</span>

    <span class="token keyword">location</span> <span class="token operator">~</span> \<span class="token punctuation">.</span>php$ <span class="token punctuation">{</span>
        <span class="token keyword">fastcgi_split_path_info</span> <span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">+</span>\<span class="token punctuation">.</span>php<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token operator">+</span><span class="token punctuation">)</span>$<span class="token punctuation">;</span>
        <span class="token keyword">fastcgi_pass</span> unix<span class="token punctuation">:</span><span class="token operator">/</span>run<span class="token operator">/</span>php<span class="token operator">-</span>fpm<span class="token operator">/</span>php<span class="token operator">-</span>fpm<span class="token punctuation">.</span>sock<span class="token punctuation">;</span> <span class="token comment"># make sure this is correct</span>
        <span class="token keyword">fastcgi_index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>php<span class="token punctuation">;</span>
        <span class="token keyword">include</span> fastcgi_params<span class="token punctuation">;</span>
        <span class="token keyword">fastcgi_param</span> SCRIPT_FILENAME <span class="token variable">$document_root</span><span class="token variable">$fastcgi_script_name</span><span class="token punctuation">;</span> <span class="token comment"># or $request_filename</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">!</span>well<span class="token operator">-</span>known<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token punctuation">{</span>
        <span class="token keyword">deny</span> all<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">server</span> <span class="token punctuation">{</span>                                             <span class="token comment"># Redirect http to https</span>
    <span class="token keyword">server_name</span> pixelfed<span class="token punctuation">.</span>example<span class="token punctuation">;</span>                    <span class="token comment"># change this to your fqdn</span>
    <span class="token keyword">listen</span> <span class="token number">80</span><span class="token punctuation">;</span>
    <span class="token keyword">listen</span> <span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token number">80</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">301</span> <span class="token keyword">https</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token variable">$host</span><span class="token variable">$request_uri</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">FastCGI path</p> <p>Make sure to use the correct <code>fastcgi_pass</code> socket path for your distribution and version of PHP-FPM. For example, on Arch, this is <code>/run/php-fpm/php-fpm.sock</code>, but on Ubuntu it may be <code>/run/php/php7.3-fpm.sock</code>, on Debian it may be <code>/var/run/php/php7.3-fpm.sock</code>, and so on. If you have configured a PHP server over TCP, you may also pass to its IP and port, e.g. <code>localhost:9000</code> by default.</p></div> <h3 id="https-certificate"><a href="#https-certificate" aria-hidden="true" class="header-anchor">#</a> HTTPS Certificate</h3> <p>For local development, you may generate a self-signed SSL certificate. For example:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">mkdir</span> /etc/nginx/ssl
$ <span class="token function">sudo</span> openssl req -x509 -nodes -days <span class="token number">365</span> -newkey rsa:2048 -keyout /etc/nginx/ssl/server.key -out /etc/nginx/ssl/server.crt
</code></pre></div><p>For production deployments, you will need to obtain a certificate from a certificate authority. You may automate certification from LetsEncrypt, a free certificate authority, by using a utility such as <a href="https://certbot.eff.org/" target="_blank" rel="noopener noreferrer">EFF Certbot<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or <a href="https://acme.sh" target="_blank" rel="noopener noreferrer">acme.sh<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/pixelfed/docs/edit/master/installing-pixelfed/postinstall.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/installing-pixelfed/installation.html" class="prev">
          Generic installation process
        </a></span> <span class="next"><a href="/running-pixelfed/administration.html">
          Administration
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b7dfad19.js" defer></script><script src="/assets/js/2.a454a886.js" defer></script><script src="/assets/js/11.9126097e.js" defer></script>
  </body>
</html>
